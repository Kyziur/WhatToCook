
<div [ngSwitch]="getDisplayMode()">
  <div *ngSwitchCase="0">
    <ng-container *ngTemplateOutlet="editable"></ng-container>
  </div>
  <div *ngSwitchCase="1">
    <ng-container *ngTemplateOutlet="editable"></ng-container>
  </div>
  <div *ngSwitchCase="2">
    <ng-container *ngTemplateOutlet="view"></ng-container>
  </div>
</div>

<ng-template #view>
  <h2>{{ recipe?.name }}</h2>
  <ul>
    <li *ngFor="let ingredient of recipe?.ingredients">{{ ingredient }}</li>
  </ul>
  <p>{{ recipe?.preparationDescription }}</p>
  <p>Time to prepare: {{ recipe?.timeToPrepare }}</p>
  <img class= "recipe-card-image" src="{{ getImagePath() }}" alt="{{ recipe?.name }} image" />
  <button type="button" (click)="enableEdit()">Edit</button>
</ng-template>

<ng-template #editable>
  <ng-container *ngIf="recipeForm">
    <form [formGroup]="recipeForm" (ngSubmit)="submit()">
      <div class="form-group">
        <label>Name:</label>
        <input type="text" formControlName="name" class="form-control">
      </div>
      <div>
        <input type="file" name="image" (change)="onFileSelected($event)">
      </div>
      <div formArrayName="ingredients" class="mb-3">
        <label class="form-label">Ingredients</label>
        <div *ngFor="let ingredient of ingredientsControls.controls; let i=index">
          <input title="Ingredient input" type="text" [formControlName]="i" />
        </div>
        <button type="button" (click)="addIngredient()">Add ingredient</button>
      </div>
      <div class="form-group">
        <label>Preparation Description:</label>
        <textarea formControlName="preparationDescription" class="form-control"></textarea>
      </div>
      <div class="form-group">
        <label>Time to Prepare:</label>
        <select formControlName="timeToPrepare" class="form-control">
          <option value="Short">Short</option>
          <option value="Medium">Medium</option>
          <option value="Long">Long</option>
        </select>
      </div>      
      <button type="submit" [disabled]="!recipeForm.valid">Save</button>
    </form>
  </ng-container>
</ng-template>
